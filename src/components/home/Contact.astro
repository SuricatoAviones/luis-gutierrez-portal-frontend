---
// src/components/sections/Contact.astro
// Este formulario envía un POST a /api/contact.ts (endpoint Astro)
// Puedes conectarlo a Formspree, Resend, Nodemailer, etc.
---

<section id="contacto" class="py-24 lg:py-32 bg-ink text-parchment">
  <div class="max-w-content mx-auto px-6 lg:px-10">

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-16 items-start">

      <!-- Info de contacto -->
      <div class="lg:col-span-5 reveal">
        <div class="flex items-center gap-4 mb-10">
          <span class="font-mono text-2xs text-accent uppercase tracking-widest">06</span>
          <span class="block w-8 h-px bg-accent"></span>
          <h2 class="font-display text-3xl lg:text-4xl font-semibold text-parchment">Contacto</h2>
        </div>

        <p class="text-parchment/70 text-lg font-light leading-relaxed mb-10">
          ¿Tienes un proyecto en mente? Me encantaría escucharte. 
          Escríbeme y te respondo en menos de 24 horas.
        </p>

        <!-- Datos de contacto -->
        <div class="space-y-6">
          {[
            {
              label: 'Email',
              value: 'hola@luisangelgutierrez.com',
              href: 'mailto:hola@luisangelgutierrez.com',
              icon: `<svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" /></svg>`,
            },
            {
              label: 'LinkedIn',
              value: 'linkedin.com/in/luisangelgutierrez',
              href: 'https://linkedin.com/in/tu-usuario',
              icon: `<svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>`,
            },
            {
              label: 'GitHub',
              value: 'github.com/tu-usuario',
              href: 'https://github.com/tu-usuario',
              icon: `<svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.44 9.8 8.21 11.38.6.11.82-.26.82-.58v-2.03c-3.34.73-4.04-1.61-4.04-1.61-.55-1.39-1.33-1.76-1.33-1.76-1.09-.74.08-.73.08-.73 1.2.09 1.84 1.24 1.84 1.24 1.07 1.83 2.81 1.3 3.5 1 .11-.78.42-1.3.76-1.6-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.13-.3-.54-1.52.12-3.18 0 0 1.01-.32 3.3 1.23a11.5 11.5 0 013-.4c1.02.01 2.04.14 3 .4 2.28-1.55 3.29-1.23 3.29-1.23.66 1.66.25 2.88.12 3.18.77.84 1.24 1.91 1.24 3.22 0 4.61-2.81 5.63-5.48 5.92.43.37.81 1.1.81 2.22v3.29c0 .32.22.7.83.58C20.57 21.8 24 17.3 24 12c0-6.63-5.37-12-12-12z"/></svg>`,
            },
          ].map(({ label, value, href, icon }) => (
            <a
              href={href}
              target={href.startsWith('http') ? '_blank' : undefined}
              rel={href.startsWith('http') ? 'noopener noreferrer' : undefined}
              class="flex items-center gap-4 group"
            >
              <div class="w-9 h-9 rounded-full bg-parchment/10 flex items-center justify-center text-parchment group-hover:bg-accent group-hover:text-parchment transition-all duration-200">
                <Fragment set:html={icon} />
              </div>
              <div>
                <p class="font-mono text-2xs text-parchment/40 uppercase tracking-wider">{label}</p>
                <p class="text-sm text-parchment group-hover:text-accent transition-colors">{value}</p>
              </div>
            </a>
          ))}
        </div>
      </div>

      <!-- Formulario -->
      <div class="lg:col-span-7 reveal [animation-delay:150ms]">
        <form
          id="contact-form"
          class="bg-parchment/5 border border-parchment/10 rounded-2xl p-8 space-y-5"
          novalidate
        >
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
            <!-- Nombre -->
            <div>
              <label for="name" class="block font-mono text-2xs text-parchment/50 uppercase tracking-wider mb-2">
                Nombre
              </label>
              <input
                id="name"
                name="name"
                type="text"
                required
                placeholder="Tu nombre"
                class="w-full bg-parchment/5 border border-parchment/15 rounded-xl px-4 py-3 text-sm text-parchment placeholder-parchment/30 focus:outline-none focus:border-accent transition-colors duration-200"
              />
            </div>
            <!-- Email -->
            <div>
              <label for="email" class="block font-mono text-2xs text-parchment/50 uppercase tracking-wider mb-2">
                Email
              </label>
              <input
                id="email"
                name="email"
                type="email"
                required
                placeholder="tu@email.com"
                class="w-full bg-parchment/5 border border-parchment/15 rounded-xl px-4 py-3 text-sm text-parchment placeholder-parchment/30 focus:outline-none focus:border-accent transition-colors duration-200"
              />
            </div>
          </div>

          <!-- Asunto -->
          <div>
            <label for="subject" class="block font-mono text-2xs text-parchment/50 uppercase tracking-wider mb-2">
              Asunto
            </label>
            <input
              id="subject"
              name="subject"
              type="text"
              placeholder="¿En qué puedo ayudarte?"
              class="w-full bg-parchment/5 border border-parchment/15 rounded-xl px-4 py-3 text-sm text-parchment placeholder-parchment/30 focus:outline-none focus:border-accent transition-colors duration-200"
            />
          </div>

          <!-- Mensaje -->
          <div>
            <label for="message" class="block font-mono text-2xs text-parchment/50 uppercase tracking-wider mb-2">
              Mensaje
            </label>
            <textarea
              id="message"
              name="message"
              required
              rows="5"
              placeholder="Cuéntame sobre tu proyecto..."
              class="w-full bg-parchment/5 border border-parchment/15 rounded-xl px-4 py-3 text-sm text-parchment placeholder-parchment/30 focus:outline-none focus:border-accent transition-colors duration-200 resize-none"
            ></textarea>
          </div>

          <!-- Submit -->
          <button
            type="submit"
            id="submit-btn"
            class="w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-accent text-parchment text-sm font-medium rounded-xl hover:bg-accent/90 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            <span id="btn-text">Enviar mensaje</span>
            <svg id="btn-icon" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
            </svg>
          </button>

          <!-- Mensaje de estado -->
          <div id="form-status" class="hidden text-sm text-center font-medium py-3 rounded-xl"></div>
        </form>
      </div>
    </div>

  </div>
</section>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const btn = document.getElementById('submit-btn') as HTMLButtonElement;
  const btnText = document.getElementById('btn-text')!;
  const status = document.getElementById('form-status')!;

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    btn.disabled = true;
    btnText.textContent = 'Enviando...';

    const data = Object.fromEntries(new FormData(form));

    try {
      // Reemplaza TU_FORM_ID con el ID de tu formulario en https://formspree.io
      const res = await fetch('https://formspree.io/f/TU_FORM_ID', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', Accept: 'application/json' },
        body: JSON.stringify(data),
      });

      if (res.ok) {
        status.textContent = '✓ ¡Mensaje enviado! Te responderé pronto.';
        status.className = 'text-sm text-center font-medium py-3 rounded-xl bg-accent/20 text-accent';
        form.reset();
      } else {
        throw new Error('Error');
      }
    } catch {
      status.textContent = '✗ Algo salió mal. Escríbeme directamente al email.';
      status.className = 'text-sm text-center font-medium py-3 rounded-xl bg-red-500/20 text-red-300';
    } finally {
      status.classList.remove('hidden');
      btn.disabled = false;
      btnText.textContent = 'Enviar mensaje';
    }
  });
</script>